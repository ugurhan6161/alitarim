(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[989],{67:function(){},2061:function(){},2558:function(e,r,t){Promise.resolve().then(t.bind(t,4456))},4456:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return Q}});var n=t(7437),i=t(2265),a=t(2298),s=t(2869),l=t(5186),d=t(6815),c=t(3647),o=t(8575),u=t(3966),m=t(6741),h=t(886),x=t(6718),p=t(420),f=t(1599),j=t(6840),b="Checkbox",[v,y]=(0,u.b)(b),[N,g]=v(b),k=i.forwardRef((e,r)=>{let{__scopeCheckbox:t,name:a,checked:s,defaultChecked:l,required:d,disabled:c,value:u="on",onCheckedChange:x,form:p,...f}=e,[b,v]=i.useState(null),y=(0,o.e)(r,e=>v(e)),g=i.useRef(!1),k=!b||p||!!b.closest("form"),[w=!1,C]=(0,h.T)({prop:s,defaultProp:l,onChange:x}),E=i.useRef(w);return i.useEffect(()=>{let e=null==b?void 0:b.form;if(e){let r=()=>C(E.current);return e.addEventListener("reset",r),()=>e.removeEventListener("reset",r)}},[b,C]),(0,n.jsxs)(N,{scope:t,state:w,disabled:c,children:[(0,n.jsx)(j.WV.button,{type:"button",role:"checkbox","aria-checked":R(w)?"mixed":w,"aria-required":d,"data-state":z(w),"data-disabled":c?"":void 0,disabled:c,value:u,...f,ref:y,onKeyDown:(0,m.M)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,m.M)(e.onClick,e=>{C(e=>!!R(e)||!e),k&&(g.current=e.isPropagationStopped(),g.current||e.stopPropagation())})}),k&&(0,n.jsx)(S,{control:b,bubbles:!g.current,name:a,value:u,checked:w,required:d,disabled:c,form:p,style:{transform:"translateX(-100%)"},defaultChecked:!R(l)&&l})]})});k.displayName=b;var w="CheckboxIndicator",C=i.forwardRef((e,r)=>{let{__scopeCheckbox:t,forceMount:i,...a}=e,s=g(w,t);return(0,n.jsx)(f.z,{present:i||R(s.state)||!0===s.state,children:(0,n.jsx)(j.WV.span,{"data-state":z(s.state),"data-disabled":s.disabled?"":void 0,...a,ref:r,style:{pointerEvents:"none",...e.style}})})});C.displayName=w;var S=e=>{let{control:r,checked:t,bubbles:a=!0,defaultChecked:s,...l}=e,d=i.useRef(null),c=(0,x.D)(t),o=(0,p.t)(r);i.useEffect(()=>{let e=d.current,r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==t&&r){let n=new Event("click",{bubbles:a});e.indeterminate=R(t),r.call(e,!R(t)&&t),e.dispatchEvent(n)}},[c,t,a]);let u=i.useRef(!R(t)&&t);return(0,n.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:null!=s?s:u.current,...l,tabIndex:-1,ref:d,style:{...e.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function R(e){return"indeterminate"===e}function z(e){return R(e)?"indeterminate":e?"checked":"unchecked"}var E=t(401),I=t(4508);let M=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)(k,{ref:r,className:(0,I.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...i,children:(0,n.jsx)(C,{className:(0,I.cn)("flex items-center justify-center text-current"),children:(0,n.jsx)(E.Z,{className:"h-4 w-4"})})})});M.displayName=k.displayName;var A=t(7992),B=t(2093),_=t(4430),T=t(5243),D=t(875);let P=(0,t(9205).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var O=t(8930),V=t(3578),F=t(9376);function Q(){let{customers:e,setCustomers:r,partners:t}=(0,a.b)(),[o,u]=(0,i.useState)({name:"",partnerId:0}),[m,h]=(0,i.useState)(null),[x,p]=(0,i.useState)(null),[f,j]=(0,i.useState)(!1),[b,v]=(0,i.useState)(!1),[y,N]=(0,i.useState)(null),[g,k]=(0,i.useState)([]),[w,C]=(0,i.useState)(0),[S,R]=(0,i.useState)([]),[z,E]=(0,i.useState)(0),I=(0,F.useRouter)(),Q=(0,i.useMemo)(()=>{let r={};return e.forEach(e=>{r[e.partnerId]||(r[e.partnerId]=[]),r[e.partnerId].push(e)}),r},[e]),H=(t,n)=>{r(e.map(e=>e.id===t?{...e,partnerId:n}:e)),h(null),(0,A.Am)({title:"Başarılı",description:"M\xfcşteri bilgileri g\xfcncellendi."})},Z=e=>{N(e),v(!0)},q=e=>{k(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])},K=e=>{R(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])};return(0,n.jsxs)(T.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3},className:"space-y-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"M\xfcşteriler"}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)(_.u_,{open:f,onOpenChange:j,children:[(0,n.jsx)(_.iq,{asChild:!0,children:(0,n.jsx)(s.z,{onClick:()=>j(!0),children:"Yeni M\xfcşteri Ekle"})}),(0,n.jsxs)(_.hz,{"aria-describedby":"add-customer-description",children:[(0,n.jsx)(_.xB,{children:(0,n.jsx)(_.r6,{children:"Yeni M\xfcşteri Ekle"})}),(0,n.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,n.jsx)("p",{id:"add-customer-description",children:"Yeni bir m\xfcşteri eklemek i\xe7in aşağıdaki formu doldurun."}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(d._,{htmlFor:"name",children:"İsim"}),(0,n.jsx)(l.I,{id:"name",value:o.name,onChange:e=>u({...o,name:e.target.value})})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(d._,{htmlFor:"partnerId",children:"İş Ortağı"}),(0,n.jsxs)(c.Ph,{onValueChange:e=>u({...o,partnerId:Number(e)}),children:[(0,n.jsx)(c.i4,{children:(0,n.jsx)(c.ki,{placeholder:"İş ortağı se\xe7in"})}),(0,n.jsx)(c.Bw,{children:t.map(e=>(0,n.jsx)(c.Ql,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,n.jsx)(s.z,{onClick:()=>{if(o.name&&o.partnerId){if(e.some(e=>e.name===o.name)){(0,A.Am)({title:"Hata",description:"Bu isimde bir m\xfcşteri zaten var.",variant:"destructive"});return}r([...e,{...o,id:Date.now()}]),u({name:"",partnerId:0}),j(!1),(0,A.Am)({title:"Başarılı",description:"M\xfcşteri başarıyla eklendi."})}},children:"M\xfcşteri Ekle"})]})]})]}),(0,n.jsxs)("div",{className:"w-full max-w-[400px] min-h-[100px] bg-white shadow-lg rounded-lg p-4 relative",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(l.I,{type:"file",accept:".xlsx, .xls",onChange:e=>{e.target.files&&p(e.target.files[0])},className:"w-64"}),(0,n.jsx)(s.z,{onClick:()=>{if(x){let t=new FileReader;t.onload=t=>{var n;let i=null===(n=t.target)||void 0===n?void 0:n.result,a=B.ij(i,{type:"array"}),s=a.SheetNames[0],l=a.Sheets[s],d=B.P6.sheet_to_json(l),c=new Map;d.forEach(r=>{let t=r.MUSTERI_ADI;c.has(t)||e.some(e=>e.name===t)||c.set(t,{id:Date.now()+Math.random(),name:t,partnerId:z||0})});let o=Array.from(c.values());r(e=>[...e,...o]),(0,A.Am)({title:"Başarılı",description:"".concat(o.length," yeni benzersiz m\xfcşteri eklendi.")})},t.readAsArrayBuffer(x)}},children:"Excel'i İşle"})]}),(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsxs)(c.Ph,{onValueChange:e=>E(Number(e)),children:[(0,n.jsx)(c.i4,{className:"w-64",children:(0,n.jsx)(c.ki,{placeholder:"Excel i\xe7in iş ortağı se\xe7in (opsiyonel)"})}),(0,n.jsxs)(c.Bw,{children:[(0,n.jsx)(c.Ql,{value:"0",children:"Atanmamış"}),t.map(e=>(0,n.jsx)(c.Ql,{value:e.id.toString(),children:e.name},e.id))]})]})})]})]}),(0,n.jsx)(_.u_,{open:b,onOpenChange:v,children:(0,n.jsxs)(_.hz,{"aria-describedby":"delete-customer-description",children:[(0,n.jsx)(_.xB,{children:(0,n.jsx)(_.r6,{children:"M\xfcşteriyi Sil"})}),(0,n.jsx)("div",{className:"py-4",children:(0,n.jsx)("p",{id:"delete-customer-description",children:"Bu m\xfcşteriyi silmek istediğinizden emin misiniz? Bu işlem geri alınamaz."})}),(0,n.jsxs)(_.mz,{children:[(0,n.jsx)(s.z,{variant:"outline",onClick:()=>v(!1),children:"İptal"}),(0,n.jsx)(s.z,{variant:"destructive",onClick:()=>{y&&(r(e.filter(e=>e.id!==y)),v(!1),N(null),(0,A.Am)({title:"Başarılı",description:"M\xfcşteri başarıyla silindi.",duration:3e3}))},children:"Sil"})]})]})}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,n.jsxs)(c.Ph,{value:w.toString(),onValueChange:e=>C(Number(e)),children:[(0,n.jsx)(c.i4,{className:"w-[200px]",children:(0,n.jsx)(c.ki,{placeholder:"İş ortağı se\xe7in"})}),(0,n.jsx)(c.Bw,{children:t.map(e=>(0,n.jsx)(c.Ql,{value:e.id.toString(),children:e.name},e.id))})]}),(0,n.jsx)(s.z,{onClick:()=>{w&&g.length>0&&(r(e.map(e=>g.includes(e.id)?{...e,partnerId:w}:e)),k([]),C(0),(0,A.Am)({title:"Başarılı",description:"".concat(g.length," m\xfcşteri se\xe7ilen iş ortağına atandı."),duration:3e3}),setTimeout(()=>{I.refresh()},1e3))},disabled:!w||0===g.length,children:"Se\xe7ili M\xfcşterileri Ata"})]}),(0,n.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,n.jsxs)(V.iA,{children:[(0,n.jsx)(V.xD,{children:(0,n.jsxs)(V.SC,{children:[(0,n.jsx)(V.ss,{className:"w-[50px]"}),(0,n.jsx)(V.ss,{children:"M\xfcşteri Adı"}),(0,n.jsx)(V.ss,{children:"İş Ortağı"}),(0,n.jsx)(V.ss,{className:"w-[100px]",children:"İşlemler"})]})}),(0,n.jsx)(V.RM,{children:Object.entries(Q).map(e=>{let[r,a]=e,l=t.find(e=>e.id===Number(r)),d=S.includes(Number(r));return(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)(V.SC,{className:"bg-muted/50",children:(0,n.jsx)(V.pj,{colSpan:4,children:(0,n.jsxs)("button",{onClick:()=>K(Number(r)),className:"flex items-center space-x-2",children:[d?(0,n.jsx)(D.Z,{className:"h-4 w-4"}):(0,n.jsx)(P,{className:"h-4 w-4"}),(0,n.jsxs)("span",{children:[l?l.name:"Atanmamış"," (",a.length,")"]})]})})}),d&&a.map(e=>{var r;return(0,n.jsxs)(V.SC,{children:[(0,n.jsx)(V.pj,{children:(0,n.jsx)(M,{checked:g.includes(e.id),onCheckedChange:()=>q(e.id)})}),(0,n.jsx)(V.pj,{children:e.name}),(0,n.jsx)(V.pj,{children:m===e.id?(0,n.jsxs)(c.Ph,{onValueChange:r=>{H(e.id,Number(r))},defaultValue:e.partnerId.toString(),children:[(0,n.jsx)(c.i4,{children:(0,n.jsx)(c.ki,{placeholder:"İş ortağı se\xe7in"})}),(0,n.jsx)(c.Bw,{children:t.map(e=>(0,n.jsx)(c.Ql,{value:e.id.toString(),children:e.name},"partner-".concat(e.id)))})]}):(null===(r=t.find(r=>r.id===e.partnerId))||void 0===r?void 0:r.name)||"Atanmamış"}),(0,n.jsx)(V.pj,{children:m===e.id?(0,n.jsx)(s.z,{variant:"outline",size:"sm",onClick:()=>h(null),children:"Kaydet"}):(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)(s.z,{variant:"outline",size:"sm",onClick:()=>h(e.id),children:"D\xfczenle"}),(0,n.jsx)(s.z,{variant:"ghost",size:"sm",onClick:()=>Z(e.id),children:(0,n.jsx)(O.Z,{className:"h-4 w-4"})})]})})]},"customer-".concat(e.id))})]},"group-".concat(r))})})]})})]})}},3578:function(e,r,t){"use strict";t.d(r,{RM:function(){return d},SC:function(){return c},iA:function(){return s},pj:function(){return u},ss:function(){return o},xD:function(){return l}});var n=t(7437),i=t(2265),a=t(4508);let s=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("div",{className:"relative w-full overflow-auto",children:(0,n.jsx)("table",{ref:r,className:(0,a.cn)("w-full caption-bottom text-sm",t),...i})})});s.displayName="Table";let l=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("thead",{ref:r,className:(0,a.cn)("[&_tr]:border-b",t),...i})});l.displayName="TableHeader";let d=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("tbody",{ref:r,className:(0,a.cn)("[&_tr:last-child]:border-0",t),...i})});d.displayName="TableBody",i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("tfoot",{ref:r,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...i})}).displayName="TableFooter";let c=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("tr",{ref:r,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...i})});c.displayName="TableRow";let o=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("th",{ref:r,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...i})});o.displayName="TableHead";let u=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("td",{ref:r,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...i})});u.displayName="TableCell",i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("caption",{ref:r,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",t),...i})}).displayName="TableCaption"},9376:function(e,r,t){"use strict";var n=t(5475);t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[425,569,243,481,248,502,495,971,117,744],function(){return e(e.s=2558)}),_N_E=e.O()}]);